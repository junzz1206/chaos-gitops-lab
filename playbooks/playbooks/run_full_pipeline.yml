# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# playbooks/run_full_pipeline.yml
# ì „ì²´ Chaos Lab íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
#   1. Namespace ìƒì„±
#   2. App ë°°í¬
#   3. Chaos Test ì‹¤í–‰
#   4. ì „ì²´ ë³µêµ¬
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

- name: ğŸš€ Deploy Namespace
  hosts: k3s_master
  become: yes
  tasks:
    - name: Apply namespace manifest
      ansible.builtin.command:
        cmd: kubectl apply -f namespace/app.yaml
      args:
        chdir: "{{ playbook_dir }}/.."

- name: ğŸ§© Deploy Application Manifests
  hosts: k3s_master
  become: yes
  tasks:
    - name: Apply all app manifests
      ansible.builtin.command:
        cmd: kubectl apply -f app/
      args:
        chdir: "{{ playbook_dir }}/.."

- name: ğŸ’£ Run Chaos Experiments
  import_playbook: chaos/run_chaos_test.yml

- name: ğŸ›  Restore All Services
  import_playbook: chaos/restore_all.yml

